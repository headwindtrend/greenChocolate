<link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAASDSURBVEhL5VVNaFxVFD7nvnff7+SvadLaVvKDFCXUatCFKXVVtasiCCKIIBRRCWRRpYIRcaFrcefCjaAbN9aNUrSoSJt0UWOliBXj9EdrITWdyZs3M+/nvuO5b16SmXRsWqEL8ZvLm/OGe7/v/N0zePz1p+FOQhTfdwz/K4EMIFSQUvF6i9i8yIsJzCfGKbCWbC+QkkwDonjKhvFG8ATVh8xNXLyZQI3w49j6Cp0681oWSZNsFjDRNAiZFzGKnqxefSldKQ50wz/qn4vhcOgcM9wak/quXiUPPBd9j/TTAc+Gvp5Pd93zzMD4b6kqjt2A7gKLCb2VeiuuC64Dvp+VfGYnj+386bmsASWW5F/c69u3HR3fW866F6eLQJDBbOTWHRc0o3acXAt8G3rYtrXh20UEvpu/OrUtg0dHJsJuGl0EPohl1fcyR7IAeypdu8eVw4JGRHZflOypx7vDaAdmg5ZpOTY6FlgmWUYwOPR+/1BB0YaNRS4nNI394HISNPto2Hzv2zOTcaMURxJx1R/kng1S+mZ05IWD+4LhflAKVCaazQ8XvhvmbW3YGMFJJcG2eBFruM7b5355vF7ZomIpEBWgQiBexBK9Jh66dPHdT75mG7ipDEmef6JvuCBaxUaBE8IFwyQpOXC05eRyNQUkjez6Aw8nvi+ilLcRkgJSSHtq10BwZIJlyMDj/kBOs44OAb6rS6ZNlmQB7nqQsnclYDZ2GpGMR6bw8y8bL77cXGliyhK8HXqiRAfUKi/hSl+/NtrQIbAUZ6kp+CoBs5smGYapw9f02kEiAUI+f1jOnw4OHOQQMP99HQgN2wrZnTZ0poh9MSXwReUBYAo0mAHzSwvaQ3ZZnyX44az89XzrOiPnR7uvq6KPG0Zr7xo6BEqmEAZQkVNkI+UzrQOcD8R4YSE+MmMcmfYvXyDew7R5wbXzeidAnPodAXQK+AZuTRLekC/9qUlL5CFzIO4XnzmvzfjfzwspeDIoLU0NltHQ9eD3sUYtN9bRmSKASYi1xxkREyia27VTcIMThyScK7+LlItrcCI4mjxGOj24tTiZZ2lv5a/ibRUbBR4KK8CTS2WtuzNzaP+x3RN/kqOUoFQRp0xlrB2nWDa8j3aMvfHUY3ksGshjvHKtZa+hy7ieFgOL27bzRcsnnSWk7caGVJJilSWceaEMzEyVlozUpCxLivQAPXrxwuzl862XNWyMgDGrqrAS8r8Kco83YorjUCZVr1ntj4OhtDqY1PqjeimNkZs6ZnbUi0rLy8/+US4o2tBFgAfZm8EVbDQgaiILNCJoxpSkkHLeMswyrq1untzQvQvKDyqv/Hx2NIsLijYYz+2fKMw23I3ZzkZ4Cmzdi9zmLaKWwc/Watkq61lefvWnH6e4O7qhuwBjDNS+sHKmzvmxBPuu3Vfa6zTN65+Pz7B5f3nxnavleyEpjt2Azf/05xKYs3tPWqXQ89F1dMcoNUbRg0HlQL06Dnr23QSbC6whIKgpagAMCyx1qV133PJGHpwId5k4bt4GO+N29v4r/NcFAP4Gz5ch7V2uykIAAAAASUVORK5CYII="/>
<script>
	function drop(event){
		event.preventDefault();
		const payload=event.dataTransfer.getData("text/plain");
		const ytvid=getYtvid(payload);
		if (ytvid!==null){
			dropsub(ytvid,payload);
			autosave+=ytvid+String.fromCharCode(10);
			localStorage.setItem("playground.remaining",autosave);
			updateStorage(ytvid,"Drop");
		}
		removeDropBox();
	}
	function dropsub(ytvid,desctext){
		const desc=document.createElement("span");
		desc.innerText=desctext;
		desc.setAttribute("oncontextmenu","rmvifrm('"+ytvid+"');return false");
		desc.setAttribute("onmouseenter","const rmv=document.createElement('button');this.appendChild(rmv);rmv.outerHTML='<button id=rmvButton onclick=rmvifrm(&apos;"+ytvid+"&apos;); style=cursor:pointer;background-color:mediumseagreen;color:red;font-size:20;font-weight:bold;>Remove</button>';");
		desc.setAttribute("onmouseleave","const rmv=document.getElementById('rmvButton');if (rmv) rmv.remove();");
		const frpr=document.createElement("span");
		frpr.innerText="ðŸ‘†";
		frpr.style="cursor:pointer;";
		frpr.setAttribute("onclick","updateStorage('"+ytvid+"','Play');alert('A play is logged');");
		desc.insertBefore(frpr,desc.firstChild);
		const ifrm=document.createElement("iframe");
		ifrm.id="yti"+ytvid;
		ifrm.width="100%";ifrm.height="100%";
		ifrm.src="https://www.youtube.com/embed/"+ytvid;
		ifrm.title="YouTube video player";
		ifrm.frameborder="0";
		ifrm.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
		ifrm.allowfullscreen=true;
		ifrm.addEventListener("load",function(){
			const w=ifrm.contentWindow;
			const d=w.document;
			const beg=Date.now();
			while (d.querySelector("body")===null&&Date.now()-beg<30000){
				continue
			}
			if (d.querySelector("body")!==null){
				const b=d.querySelector("body");
				const beg=Date.now();
				while (!b.innerHTML.match("ytp-button")&&Date.now()-beg<10000){
					continue
				}
				if (b.innerHTML.match("ytp-button")){
					const s=d.createElement("svg");
					b.appendChild(s);
					s.outerHTML="<svg width='100' height='100' onmouseenter='psSlider.style.display=(psSlider.style.display===&quot;none&quot;?&quot;block&quot;:&quot;none&quot;);svgYtp.style.display=(svgYtp.style.display===&quot;none&quot;?&quot;block&quot;:&quot;none&quot;);this.querySelector(&quot;circle&quot;).style.fillOpacity=1;' onmouseleave='this.querySelector(&quot;circle&quot;).style.fillOpacity=.2;' onclick='parent.window.rmvifrm(&quot;"+ytvid+"&quot;)' oncontextmenu='parent.window.logplay(&quot;"+ytvid+"&quot;);svgYtp.style.display=&quot;none&quot;;return false' style='position:fixed;top:60;right:0'><circle cx='50' cy='50' r='50' style='fill:mediumseagreen;fill-opacity:.2'/><title>Remove this video from this page</title></svg>";
					const ytp=d.createElement("svg");
					b.appendChild(ytp);
					ytp.outerHTML="<svg id='svgYtp' width='120' height='80' onmouseenter='this.querySelector(&quot;rect&quot;).style.fillOpacity=1;this.querySelector(&quot;polygon&quot;).style.fillOpacity=1;' onmouseleave='this.querySelector(&quot;rect&quot;).style.fillOpacity=.2;this.querySelector(&quot;polygon&quot;).style.fillOpacity=.2;' onclick='parent.window.logplay(&quot;"+ytvid+"&quot;,false);this.style.display=&quot;none&quot;;' style='display:none;position:fixed;top:70;right:110'><rect width='120' height='80' rx='15' ry='15' style='fill:red;fill-opacity:.2'/><polygon points='50,20 85,40 50,60' style='fill:white;fill-opacity:.2'/><title>Play this video</title></svg>";
					const sli=d.createElement("div");
					b.appendChild(sli);
					const h=w.innerHeight-300;
					const y=[h*3/14,h*7/14,h*11/14];
					sli.innerHTML="<input type=range min=0.25 step=0.25 max=3.75 value=1 style='position:fixed;top:200px;right:54px;width:calc(100vh - 300px);transform:rotate(270deg);transform-origin: top right;' oninput=document.getElementsByTagName('video')[0].playbackRate=event.target.value; ontouchstart=event.stopPropagation();><svg id=VisCue style='position:fixed;top:200;right:0;width:40;height:calc(100vh - 300px);'><polygon points='0,"+y[0]+" 9,"+(y[0]-5)+" 9,"+(y[0]+5)+"' style=fill:gray;stroke:white;stroke-width:1 /><polygon points='0,"+y[1]+" 9,"+(y[1]-5)+" 9,"+(y[1]+5)+"' style=fill:gray;stroke:white;stroke-width:1 /><polygon points='0,"+y[2]+" 9,"+(y[2]-5)+" 9,"+(y[2]+5)+"' style=fill:gray;stroke:white;stroke-width:1 /></svg>";
					sli.setAttribute("onwheel","event.preventDefault();const s=this.querySelector('input');s.value=Math.min(Math.max(0.25,Number(s.value)+(event.deltaY*-0.0025)),3.75);document.getElementsByTagName('video')[0].playbackRate=s.value;");
					sli.style.display="none";
					sli.id="psSlider";
				}
			}
		});
		prependToBody(desc);
		prependToBody(ifrm);
		document.body.scrollTop=0;
	}
	function allowDrop(event){
		event.preventDefault();
	}
	function rmvifrm(ytvid){
		const ifrm=document.getElementById("yti"+ytvid);
		if (ifrm){
			ifrm.nextElementSibling.remove();
			ifrm.parentNode.removeChild(ifrm);
			autosave=autosave.replace(ytvid+String.fromCharCode(10),"");
			localStorage.setItem("playground.remaining",autosave);
			updateStorage(ytvid,"Remove");
		}
	}
	function createDropBox(){
		if (document.querySelector("#dropbox")===null){
			const sdb=document.createElement("svg");
			document.body.appendChild(sdb);
			sdb.outerHTML="<svg id='dropbox' style='position:absolute;top:0;left:0;width:100%;height:100%;' ondrop='drop(event)' ondragover='allowDrop(event)' ondragleave='removeDropBox()' onclick='removeDropBox()'><rect style='width:100%;height:100%;fill:mediumseagreen'/></svg>";
			if (document.body.clientHeight-document.body.scrollTop<parseFloat(window.getComputedStyle(document.body).fontSize)){
				document.body.scrollTop=0;
			}
		}
	}
	function removeDropBox(){
		const sdb=document.querySelector("#dropbox");
		if (sdb!==null){
			sdb.remove();
		}
	}
	function prependToBody(element){
		document.body.insertBefore(element,document.body.firstChild);
	}
	function jumptop(){
		jumpTopIcon.style.display=(document.body.scrollTop>20?"block":"none");
	}
	function timestamp(ts=Date.now()){
		const s=new Date(ts).toString();
		const part1=s.slice(4).match(/(?:.*? ){2}/);
		const part2=s.slice(4+part1.toString().length).match(/.*? /);
		const part3=s.slice(4+part1.toString().length+part2.toString().length).match(/.*?(?= )/);
		const result=part2+part1+"("+s.slice(0,3)+") "+part3;
		return result
	}
	function updateStorage(ytvid,action){
		const lm=String.fromCharCode(92);
		txlog+=eval("timestamp()+'"+lm+"t<'+action+'> '+ytvid+'"+lm+"n'");
		localStorage.setItem("playground.txlog",txlog);
		if (vilog[ytvid]===undefined){
			vilog[ytvid]="<"+action+"> "+timestamp();
		}else{
			vilog[ytvid]+=", <"+action+"> "+timestamp();
		}localStorage.setItem("playground.vilog",JSON.stringify(vilog));
	}
	function getYtvid(payload){
		const lm=String.fromCharCode(92);
		const ytvid=eval("payload.match(/(?<="+lm+".youtube"+lm+".com"+lm+"/(?:watch"+lm+"?v=|shorts"+lm+"/))["+lm+"w"+lm+"-]+/i)");
		return ytvid
	}
	function logplay(ytvid,showPlaySpeedPanel=true){
		const ifrm=document.getElementById("yti"+ytvid);
		if (ifrm){
			updateStorage(ytvid,"Play");
			const d=ifrm.contentWindow.document;
			const nl=String.fromCharCode(10);
			d.querySelector(".ytp-cued-thumbnail-overlay").dispatchEvent(new MouseEvent("click",{view:window,bubbles:true,cancelable:true,clientX:200,clientY:200,button:0}));
			itlog[ytvid]=d.querySelector(".ytp-title-expanded-title").innerText+nl+d.querySelector(".ytp-title-text").innerText+nl+"Length "+d.querySelector(".ytp-time-duration").innerText;
			localStorage.setItem("playground.itlog",JSON.stringify(itlog));
			const dspds=localStorage.getItem("playground.defaultSpeeds");
			if (dspds){
				const channelName=d.querySelector(".ytp-title-expanded-title").innerText;
				let yetMatch="";
				dspds.split(RegExp("(?<=^.+?)>>[^>].+$","mg")).forEach(pattern=>{
					if (!yetMatch&&channelName.match(RegExp(pattern.replace(/[(].+[)]/,"").trim(),"i"))){
						if (pattern.match(/[(].+[)]/)){
							const videoTitle=d.querySelector(".ytp-title-text").innerText;
							if (videoTitle.match(RegExp(pattern.replace(/^[^(]+[(](.+)[)].*$/,"$1").trim(),"i"))) yetMatch=pattern.trim();
						}else{yetMatch=pattern.trim();}
					}
				});
				if (!yetMatch){
					const other=(dspds.match(RegExp("(?<=^ *(?:otherwise|else) *>> *)[^ ]+(?= *$)","im"))||[]).toString();
					if (other) d.getElementsByTagName('video')[0].playbackRate=other;
				}else{
					const lm=String.fromCharCode(92);
					const match=(dspds.match(RegExp("(?<=^ *"+yetMatch.replace(RegExp(lm+"W","g"),lm+'$&')+" *>> *)[^ ]+(?= *$)","im"))||[]).toString();
					if (match) d.getElementsByTagName('video')[0].playbackRate=match;
				}d.querySelector('#psSlider input').value=d.getElementsByTagName('video')[0].playbackRate;
			}
			if (showPlaySpeedPanel){
				const sb=d.querySelector(".ytp-settings-button");
				const rect=sb.getBoundingClientRect();
				const centerX=rect.left+rect.width/2;
				const centerY=rect.top+rect.height/2;
				sb.dispatchEvent(new MouseEvent("click",{view:window,bubbles:true,cancelable:true,clientX:centerX,clientY:centerY,button:0}));
				setTimeout(()=>{
					const menuItems=d.querySelectorAll(".ytp-panel .ytp-menuitem-label");
					let psp;	// playback speed panel
					menuItems.forEach(item=>{if (item.innerText==="Playback speed") psp=item;});
					if (psp){
						const rect=psp.getBoundingClientRect();
						const centerX=rect.left+rect.width/2;
						const centerY=rect.top+rect.height/2;
						psp.dispatchEvent(new MouseEvent("click",{view:window,bubbles:true,cancelable:true,clientX:centerX,clientY:centerY,button:0}));
					}else{console.log("Oops, could not find the 'Playback speed' label.");}
				},1000);
			}
		}
	}
	function showTxLog(){
		if (ondblclickDisabled){ondblclickDisabled=false;return}
		const tb=document.querySelector("#textBox");
		if (tb.style.display!=="none"){if (check_lines_sel()){tb.style.display="none"};return}
		const tbi=tb.querySelector("div");
		setTimeout(()=>{
			const atbott=(Math.abs(tbi.scrollTop+tbi.clientHeight-tbi.scrollHeight)<parseFloat(window.getComputedStyle(tb).fontSize)*0.5);
			tbi.innerText=txlog.replace(/^(?!$)/mg,"âšª ");
			setTimeout(()=>{if (tbi.scrollTop===0||atbott) tbi.scrollTop=tbi.scrollHeight},100);
			tb.querySelector("div:last-child").innerText="Total: "+(tbi.innerText.match(/^(?!$)/mg)||[]).length+" Lines"+" ".repeat(9)+"Marked: 0 Lines";
		},100);
		rButt.style.display="none";
		tbi.style.maxHeight=document.body.clientHeight-70;
		tb.style.display="block";
	}
	function sel_anchNode(){
		const selection=getSelection();
		if (selection&&selection.anchorNode){
			const sn=selection.anchorNode;
			if (sn.nodeType===Node.TEXT_NODE){return sn.parentNode}
			if (sn.nodeType===Node.ELEMENT_NODE){return sn}
		}return null
	}
	function toggleLineMarks(s=getSelection().toString(),t=sel_anchNode()){
		if (t){
			t.innerText=t.innerText.replace(s,s.replace(/[âšªâš«]/g,(m)=>{return m==="âšª"?"âš«":"âšª"}));
			const marks=t.innerText.match(/âš«/g);
			t.nextElementSibling.innerText=t.nextElementSibling.innerText.replace(RegExp("(?<=Marked: )[0-9]+"),(marks||[]).length);
			rButt.style.display=(t.innerText.match(/âš«/)?"block":"none");
		}
	}
	function check_lines_sel(){
		const tbi=document.querySelector("#textBox div");
		const matches=tbi.innerText.match(/âš«/g);
		if ((matches||[]).length>1){
			return confirm("Some lines are marked, ignore them and proceed to close the pop-up? (all marks will be reset to unmarked if proceed.)")
		}return true
	}
	function remove_marked_lines(){
		const lm=String.fromCharCode(92);
		const tbi=document.querySelector("#textBox div");
		const matches=tbi.innerText.match(/(?<=âš« ).+?$/mg);
		if (matches){
			navigator.clipboard.writeText(eval("tbi.innerText.replace(/^.*?âšª.+?("+lm+"n|$)/mg,'').replace(/âš« /g,'')")).then(()=>{},()=>{alert("Oops...")});
			setTimeout(()=>{if (confirm("Get rid of all the marked lines?")){
				matches.forEach(match=>{
					const ytvid=eval("match.match(/(?<="+lm+"s)"+lm+"S+$/)");
					const stamp=eval("match.match(/^.+?(?="+lm+"t)/)");
					vilog[ytvid]=vilog[ytvid].replace(RegExp("(?:, )?<[^>]+> "+stamp.toString().replace(/([()])/g,lm+"$1")+"(?:, )?"),(m)=>{return m.match(/, .+?, /)?", ":""});
					if (vilog[ytvid].trim()===""){
						delete vilog[ytvid];
						if (itlog[ytvid]!==undefined){
							delete itlog[ytvid];
						}
					}
				});
				localStorage.setItem("playground.vilog",JSON.stringify(vilog));
				localStorage.setItem("playground.itlog",JSON.stringify(itlog));
				tbi.innerText=eval("tbi.innerText.replace(/^.*?âš«.+?("+lm+"n|$)/mg,'')");
				txlog=tbi.innerText.replace(/âšª /g,"");
				localStorage.setItem("playground.txlog",txlog);
				rButt.style.display="none";
				tbi.nextElementSibling.innerText="Total: "+(tbi.innerText.match(/^(?!$)/mg)||[]).length+" Lines"+" ".repeat(9)+"Marked: 0 Lines";
			}},1000);
		}
	}
	function jumpBottom(target,theButton){
		theButton.style.display=(Math.abs(target.scrollTop+target.clientHeight-target.scrollHeight)<parseFloat(window.getComputedStyle(target).fontSize)*0.5?"none":"block");
	}
	function importYtvids(){
		if (document.getElementById("ytvidsImport")) return;
		const lm=String.fromCharCode(92);
		const ta=document.createElement("textarea");
		document.body.appendChild(ta);
		ta.outerHTML="<textarea id='ytvidsImport' placeholder='Paste the id list (of youtube videos) here to import' onpaste='event.stopPropagation();event.preventDefault();let tookplace=false;const payload=(event.clipboardData||window.clipboardData).getData(&quot;Text&quot;).replace(/"+lm+"r/g,&quot;&quot;);payload.split(String.fromCharCode(10)).forEach(ytvid=>{if (ytvid&&!autosave.match(ytvid)&&ytvid.match(/^["+lm+"w"+lm+"-]{11}$/)){dropsub(ytvid,&quot;https://www.youtube.com/watch?v=&quot;+ytvid);updateStorage(ytvid,&quot;Drop&quot;);tookplace=true;}});if (tookplace){autosave+=payload;autosave=removeDupLines(autosave);localStorage.setItem(&quot;playground.remaining&quot;,autosave);this.value=payload+&quot;"+lm+"n{done}&quot;}else{this.value=payload+&quot;"+lm+"n{nothing valid}&quot;}' onfocusout='this.remove()' style='width:200;height:200;max-height=var(document.body.clientHeight-20);position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)'></textarea>";
		ytvidsImport.focus();
	}
	function exportYtvids(){
		if (document.getElementById("ytvidsExport")) return;
		const theList=getPlaygroundYtvids();
		navigator.clipboard.writeText(theList).then(()=>{},()=>{alert("Oops...")});
		const ta=document.createElement("textarea");
		document.body.appendChild(ta);
		ta.outerHTML="<textarea id='ytvidsExport' onfocusout='this.remove()' style='width:200;height:200;max-height=var(document.body.clientHeight-20);position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)'>"+theList+String.fromCharCode(10)+"{Already in clipboard}</textarea>";
		ytvidsExport.focus();
	}
	function getPlaygroundYtvids(){
		const lm=String.fromCharCode(92),nl=String.fromCharCode(10);
		let theList=eval("removeDupLines(document.body.innerHTML.replace(/(?<="+lm+".youtube"+lm+".com"+lm+"/(?:watch"+lm+"?v=|shorts"+lm+"/))["+lm+"w"+lm+"-]+/ig,'"+lm+"nytvid=$&"+lm+"n').replace(/^(?!ytvid=).*("+lm+"n|$)/mg,'').replace(/^ytvid=/mg,''))").split(nl).filter(Boolean).reverse().join(nl);if (theList) theList+=nl;
		return theList
	}
	function removeDupLines(theText){
		const nl=String.fromCharCode(10);
		return [...new Set(theText.split(nl))].join(nl)
	}
	function editDefaultSpeeds(){
		if (document.querySelector("#defSpeeds")) return;
		const ta=document.createElement("textarea");
		document.body.appendChild(ta);
		ta.outerHTML="<textarea id='defSpeeds' placeholder='Default Playback Speeds setting' onfocusout='localStorage.setItem(&quot;playground.defaultSpeeds&quot;,this.value);this.remove()' style='width:300;height:300;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)'>"+(localStorage.getItem("playground.defaultSpeeds")||"")+"</textarea>";
		defSpeeds.style.maxHeight=document.body.clientHeight-20;
		defSpeeds.focus();
	}
</script>
<body ondblclick="showTxLog();" style="background:chocolate;color:white;font-size:20">
	<div id="textBox" style="display:none;width:800;border:3px solid black;padding:10;background-color:lightgray;color:black;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)" ondblclick="event.stopPropagation();">
		<button onclick="if (check_lines_sel()){this.parentNode.style.display='none'}" style="position:absolute;top:5;right:30;background-color:red;font-size:30;">&#215;</button>
		<button id="rButt" onclick="remove_marked_lines()" style="display:none;position:absolute;top:50%;right:30;transform:translateY(-50%);background-color:red;color:lightgray;font-size:30;font-weight:bold;">R</button>
		<button id="jumpBottomButton" onclick="this.parentNode.querySelector('div').scrollTop=this.parentNode.querySelector('div').scrollHeight" style="display:none;position:absolute;bottom:43;right:30;background-color:mediumseagreen;color:white;font-size:30;font-weight:bold;">âšº</button>
		<div style="overflow:auto;height:500;white-space:pre;"></div>
		<div style="margin-top:10;background:black;color:white;text-align:center;font-weight:bold;padding-bottom:5;white-space:pre;"></div>
	</div>
	<div id="imageBox" style="display:none;flex-flow:column;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:mediumseagreen;padding:5;overflow:auto;">
		<a onclick="return false"><img></a>
		<div style="overflow:auto;background:chocolate;color:white;text-align:right;padding:5"></div>
		<button id="selectByYtvid" onclick="const tbi=document.querySelector('#textBox div');const ytvid=getYtvid(this.parentNode.querySelector('a').href);tbi.innerText=(this.innerText==='Sel'?tbi.innerText.replace(RegExp('âšª(.+?'+ytvid+')$','mg'),'âš«$1'):tbi.innerText.replace(RegExp('âš«(.+?'+ytvid+')$','mg'),'âšª$1'));const marks=tbi.innerText.match(/âš«/g);tbi.nextElementSibling.innerText=tbi.nextElementSibling.innerText.replace(RegExp('(?<=Marked: )[0-9]+'),(marks||[]).length);rButt.style.display=(tbi.innerText.match(/âš«/)?'block':'none');this.parentNode.style.display='none'" style="position:absolute;bottom:5;left:5;background-color:lightgray;color:black;font-size:20;font-weight:bold;">Sel</button>
	</div>
	<svg id="jumpTopIcon" onmouseenter="this.querySelector('circle').style.fillOpacity=1;this.querySelector('polygon').style.fillOpacity=1;" onmouseleave="this.querySelector('circle').style.fillOpacity=.2;this.querySelector('polygon').style.fillOpacity=.2;" style="position:fixed;top:20;left:10;width:96;height:96" onclick="document.body.scrollTop=0"><circle cx="48" cy="48" r="48" style="fill:chocolate;fill-opacity:.2"/><polygon points="12,66 48,12 84,66" style="fill:mediumseagreen;fill-opacity:.2;stroke:white;stroke-width:3"/><title>Jump to the top</title></svg>
	<script>
		window.ondragenter=function(event){createDropBox()};
		window.onscroll=function(){jumptop()};
		jumptop();
		var autosave="";
		if (localStorage.getItem("playground.remaining")){
			if (confirm('There is remaining in "autosave" from last session, bring it back now? (if not bringing it back in time, next autosave will overwrite it.)')){
				autosave=localStorage.getItem("playground.remaining");
				autosave.split(String.fromCharCode(10)).forEach(ytvid=>{if (ytvid) dropsub(ytvid,"https://www.youtube.com/watch?v="+ytvid)});
			}
		}
		var txlog=(localStorage.getItem("playground.txlog")||"");
		var vilog=JSON.parse(localStorage.getItem("playground.vilog")||"{}");
		var itlog=JSON.parse(localStorage.getItem("playground.itlog")||"{}");
		document.querySelector("#textBox div").onscroll=function(){jumpBottom(this,document.querySelector("#jumpBottomButton"))};
		window.onkeyup=function(e){if (e.key===";"&&e.ctrlKey){showTxLog()}else if (e.key==="a"&&e.ctrlKey){if (textBox.style.display!=="none"){const tbi=document.querySelector("#textBox div");toggleLineMarks(tbi.innerText,tbi)}}else if (e.key==="Enter"&&e.altKey){importYtvids();}else if (e.key===String.fromCharCode(92)&&e.altKey){exportYtvids();}else if (e.key==="s"&&e.altKey){editDefaultSpeeds();}};
		var ondblclickDisabled=false;
		document.addEventListener("mouseup",(event)=>{
			if (getSelection().toString()&&imageBox.contains(sel_anchNode())){return}
			const selection=getSelection().toString();
			if (selection.length>0){
				if (textBox.contains(sel_anchNode())&&textBox.contains(event.target)){
					ondblclickDisabled=true;setTimeout(()=>{ondblclickDisabled=false},100);
					if (vilog.hasOwnProperty(selection.trim())){
						setTimeout(()=>{const nl=String.fromCharCode(10);const selt=selection.trim();const ib=document.querySelector("#imageBox");ib.querySelector("a img").src="https://img.youtube.com/vi/"+selt+"/hqdefault.jpg";ib.querySelector("a").href="https://www.youtube.com/watch?v="+selt;ib.querySelector("div").innerText="https://www.youtube.com/watch?v="+selt+nl+(itlog[selt]===undefined?"":itlog[selt]+nl)+vilog[selt].replace(/, /g,nl);selectByYtvid.innerText=(document.querySelector("#textBox div").innerText.match(RegExp("âšª.+?"+selt+"$","m"))?"Sel":"unSel");ib.style.maxHeight=document.body.clientHeight-10;ib.style.display="block"},150)
					}else if (selection.length>30){
						setTimeout(()=>{toggleLineMarks()},150)
					}
				}else{imageBox.style.display="none";}
			}else{imageBox.style.display="none";}
		});
	</script>
</body>
