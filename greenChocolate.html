<script>
	function drop(event){
		event.preventDefault();
		const payload=event.dataTransfer.getData("text/plain");
		const ytvid=getYtvid(payload);
		if (ytvid!==null){
			dropsub(ytvid,payload);
			autosave+=ytvid+String.fromCharCode(10);
			localStorage.setItem("playground.remaining",autosave);
		}
		removeDropBox();
	}
	function dropsub(ytvid,desctext){
		const desc=document.createElement("span");
		desc.style="font-size:20";
		desc.innerText=desctext;
		desc.setAttribute("oncontextmenu","const ytvid=getYtvid(this.innerText);this.previousElementSibling.remove();this.parentNode.removeChild(this);autosave=autosave.replace(ytvid+String.fromCharCode(10),'');localStorage.setItem('playground.remaining',autosave);return false");
		const ifrm=document.createElement("iframe");
		ifrm.width="100%";ifrm.height="100%";
		ifrm.src="https://www.youtube.com/embed/"+ytvid;
		ifrm.title="YouTube video player";
		ifrm.frameborder="0";
		ifrm.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
		ifrm.allowfullscreen=true;
		ifrm.addEventListener("load",function(){
			const w=ifrm.contentWindow;
			const d=w.document;
			const beg=Date.now();
			while (d.querySelector("body")===null&&Date.now()-beg<30000){
				continue
			}
			if (d.querySelector("body")!==null){
				const b=d.querySelector("body");
				const beg=Date.now();
				while (!b.innerHTML.match("ytp-button")&&Date.now()-beg<10000){
					continue
				}
				if (b.innerHTML.match("ytp-button")){
					const s=d.createElement("svg");
					b.appendChild(s);
					s.outerHTML="<svg width='100' height='100' onclick='this.id=&quot;clicked&quot;; parent.window.rmvifrm()' style='position:fixed;top:60;right:0'><circle cx='50' cy='50' r='50' style='fill:mediumseagreen;fill-opacity:.2'/><title>Remove this video from this page</title></svg>";
				}
			}
		});
		prependToBody(desc);
		prependToBody(ifrm);
	}
	function allowDrop(event){
		event.preventDefault();
	}
	function rmvifrm(){
		document.querySelectorAll("iframe").forEach(ifrm=>{
			ifrm.contentWindow.document.querySelectorAll("svg").forEach(isvg=>{
				if (isvg.id==="clicked"){
					const ytvid=getYtvid(ifrm.nextElementSibling.innerText);
					ifrm.nextElementSibling.remove();
					ifrm.parentNode.removeChild(ifrm);
					autosave=autosave.replace(ytvid+String.fromCharCode(10),"");
					localStorage.setItem("playground.remaining",autosave);
				}
			})
		})
	}
	function createDropBox(){
		if (document.querySelector("#dropbox")===null){
			const sdb=document.createElement("svg");
			document.body.appendChild(sdb);
			sdb.outerHTML="<svg id='dropbox' style='position:absolute;top:0;left:0;width:100%;height:100%;' ondrop='drop(event)' ondragover='allowDrop(event)' ondragleave='removeDropBox()' onclick='removeDropBox()'><rect style='width:100%;height:100%;fill:mediumseagreen'/></svg>";
		}
	}
	function removeDropBox(){
		const sdb=document.querySelector("#dropbox");
		if (sdb!==null){
			sdb.remove();
		}
	}
	function prependToBody(element){
		document.body.insertBefore(element,document.body.firstChild);
	}
	function jumpTopIcon(){
		if (document.body.scrollTop>20){
			document.querySelector("#jumptop").style.display="block";
		}else{
			document.querySelector("#jumptop").style.display="none";
		}
	}
	function getYtvid(payload){
		const lm=String.fromCharCode(92);
		const ytvid=eval("payload.match(/(?<="+lm+".youtube"+lm+".com"+lm+"/(?:watch"+lm+"?v=|shorts"+lm+"/))[^&"+lm+"/]+/i)");
		return ytvid
	}
</script>
<body style="background:chocolate;color:white">
	<svg id="jumptop" style="position:fixed;top:20;left:10;width:96;height:96" onclick="document.body.scrollTop=0"><circle cx="48" cy="48" r="48" style="fill:chocolate;fill-opacity:.2"/><polygon points="12,66 48,12 84,66" style="fill:mediumseagreen;fill-opacity:.2;stroke:white;stroke-width:3"/><title>Jump to the top</title></svg>
	<script>
		window.ondragenter=function(event){createDropBox()};
		window.onscroll=function(){jumpTopIcon()};
		jumpTopIcon();
		var autosave="";
		if (localStorage.getItem("playground.remaining")){
			if (confirm('There is remaining in "autosave" from last session, bring it back now? (if not bringing it back in time, next autosave will overwrite it.)')){
				autosave=localStorage.getItem("playground.remaining");
				autosave.split(String.fromCharCode(10)).forEach(ytvid=>{if (ytvid) dropsub(ytvid,"https://www.youtube.com/watch?v="+ytvid)});
			}
		}
	</script>
</body>
